@layer theme, base, components, utilities, overrides;

@tailwind base;
@tailwind components;
@tailwind utilities;

/* Ripple animation for background effect - GPU accelerated */
@keyframes ripple {
  0%, 100% {
    transform: translate3d(-50%, -50%, 0) scale(1);
  }
  50% {
    transform: translate3d(-50%, -50%, 0) scale(0.9);
  }
}

.animate-ripple {
  animation: ripple var(--duration, 8s) ease calc(var(--i, 0) * 0.2s) infinite;
  left: 50%;
  top: 50%;
  will-change: transform, opacity;
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Prevent horizontal scrolling */
html, body {
  overflow-x: hidden;
  max-width: 100vw;
}

@layer base {
  :root {
    color-scheme: light;
    /* Shadcn color system - Light mode (reddish-pink theme) - HSL format */
    --background: 0 0% 98%; /* #fafafa - warm white */
    --foreground: 0 0% 15%; /* #262626 - deep dark text */
    --card: 0 0% 95%; /* Lighter card in light mode */
    --card-foreground: 0 0% 15%; /* Dark text on card */
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 15%;
    --primary: 350 65% 45%; /* #c7365a - rich rose-red */
    --primary-foreground: 0 0% 100%;
    --secondary: 355 70% 75%; /* #f5a8b8 - soft rose */
    --secondary-foreground: 0 0% 15%;
    --muted: 0 0% 96%; /* #f5f5f5 - warm gray */
    --muted-foreground: 0 0% 45%; /* Improved contrast for better readability */
    --accent: 350 65% 45%; /* #c7365a - rich rose-red */
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 350 60% 80% / 0.4; /* soft rose border */
    --input: 350 60% 80% / 0.4;
    --ring: 350 65% 45%; /* rich rose-red ring */
    --radius: 0.5rem;
    
    /* Legacy color variables for backward compatibility */
    --color-primary: #f5a8b8; /* soft rose */
    --color-accent: #c7365a; /* rich rose-red */
    --color-warning: #d17a47;
    --color-neutral: #fafafa; /* warm white */
    --color-text: #262626; /* deep dark */
    --color-highlight: #d4af37;
  }

  :root[data-color-scheme='dark'],
  .dark {
    /* Shadcn color system - Dark mode (richer, darker rose-red) - HSL format */
    --background: 348 24% 7%; /* deeper red-black */
    --foreground: 0 0% 96%; /* soft light text */
    --card: 348 22% 10%; /* slightly lifted */
    --card-foreground: 0 0% 96%;
    --popover: 348 22% 9%;
    --popover-foreground: 0 0% 96%;
    --primary: 348 70% 48%; /* deeper rose-red */
    --primary-foreground: 0 0% 98%;
    --secondary: 348 46% 54%; /* muted rose */
    --secondary-foreground: 350 18% 10%;
    --muted: 348 18% 10%; /* dark red-muted */
    --muted-foreground: 0 0% 72%; /* maintain contrast */
    --accent: 348 70% 50%; /* aligned with primary but richer */
    --accent-foreground: 0 0% 98%;
    --destructive: 0 68% 54%;
    --destructive-foreground: 0 0% 98%;
    --border: 348 30% 22% / 0.32; /* subtle rose border */
    --input: 348 30% 22% / 0.32;
    --ring: 348 70% 48%; /* rose ring */
    
    /* Legacy color variables for backward compatibility */
    --color-primary: #d33b63; /* deeper rose */
    --color-accent: #d6456b; /* vibrant dark rose-red */
    --color-warning: #e68a5a;
    --color-neutral: #12090e; /* deeper dark red */
    --color-text: #f3f3f3; /* soft light */
    --color-highlight: #f0d870;
  }

  /* Alternative theme (blue/gray) - Light - HSL format */
  [data-color-theme='alternative'] {
    --background: 210 20% 98%; /* #f8f9fa - soft neutral blue-gray */
    --foreground: 0 0% 18%; /* #2d2d2d - elegant dark */
    --card: 0 0% 95%; /* Lighter card for alternative theme */
    --card-foreground: 0 0% 18%;
    --popover: 0 0% 100%;
    --popover-foreground: 0 0% 18%;
    --primary: 195 55% 30%; /* #2c5f6f - elegant blue */
    --primary-foreground: 0 0% 100%;
    --secondary: 215 20% 50%; /* #6b7c93 - soft blue-gray */
    --secondary-foreground: 0 0% 100%;
    --muted: 210 20% 98%; /* #f8f9fa */
    --muted-foreground: 0 0% 42%; /* Improved contrast */
    --accent: 195 55% 30%; /* #2c5f6f - elegant blue */
    --accent-foreground: 0 0% 100%;
    --destructive: 0 84% 60%;
    --destructive-foreground: 0 0% 100%;
    --border: 215 20% 50% / 0.3; /* soft blue-gray border */
    --input: 215 20% 50% / 0.3;
    --ring: 195 55% 30%; /* elegant blue ring */
    
    /* Legacy color variables for backward compatibility */
    --color-primary: #6b7c93; /* soft blue-gray */
    --color-accent: #2c5f6f; /* elegant blue */
    --color-warning: #d17a47;
    --color-neutral: #f8f9fa; /* soft neutral */
    --color-text: #2d2d2d; /* elegant dark */
    --color-highlight: #c9a961;
  }

  /* Alternative theme - Dark - HSL format */
  [data-color-theme='alternative']:root[data-color-scheme='dark'],
  [data-color-theme='alternative'].dark {
    --background: 210 45% 6%; /* deeper midnight blue */
    --foreground: 0 0% 95%; /* soft light */
    --card: 210 44% 10%; /* slightly lifted */
    --card-foreground: 0 0% 95%;
    --popover: 210 44% 8%;
    --popover-foreground: 0 0% 95%;
    --primary: 195 42% 40%; /* darker elegant blue */
    --primary-foreground: 0 0% 95%;
    --secondary: 215 42% 55%; /* muted blue */
    --secondary-foreground: 210 32% 8%;
    --muted: 210 36% 9%;
    --muted-foreground: 0 0% 70%; /* maintain contrast */
    --accent: 195 40% 40%; /* aligned with primary, darker */
    --accent-foreground: 0 0% 95%;
    --destructive: 0 78% 56%;
    --destructive-foreground: 0 0% 95%;
    --border: 215 26% 28% / 0.32; /* subtle blue-gray border */
    --input: 215 26% 28% / 0.32;
    --ring: 195 42% 40%; /* blue ring */
    
    /* Legacy color variables for backward compatibility */
    --color-primary: #5a7fa1; /* darker soft blue */
    --color-accent: #4b738f; /* darker elegant blue */
    --color-warning: #e68a5a;
    --color-neutral: #0a1016; /* deeper dark blue */
    --color-text: #f3f3f3; /* soft light */
    --color-highlight: #d9c27a;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  
  body {
    @apply bg-background text-foreground;
    margin: 0;
    font-family: Inter, -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    transition: background-color 0.3s ease, color 0.3s ease;
    font-feature-settings: 'kern' 1, 'liga' 1;
    text-rendering: optimizeLegibility;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
  }
  
  
  /* Enhanced Typography Scale */
  h1, .h1 {
    font-size: clamp(1.875rem, 4vw, 3rem);
    line-height: 1.2;
    font-weight: 700;
    letter-spacing: -0.02em;
  }
  
  h2, .h2 {
    font-size: clamp(1.5rem, 3vw, 2.25rem);
    line-height: 1.3;
    font-weight: 600;
    letter-spacing: -0.01em;
  }
  
  h3, .h3 {
    font-size: clamp(1.25rem, 2.5vw, 1.875rem);
    line-height: 1.4;
    font-weight: 600;
    letter-spacing: -0.005em;
  }
  
  h4, .h4 {
    font-size: clamp(1.125rem, 2vw, 1.5rem);
    line-height: 1.5;
    font-weight: 500;
  }
  
  h5, .h5 {
    font-size: 1rem;
    line-height: 1.5;
    font-weight: 500;
  }
  
  h6, .h6 {
    font-size: 0.875rem;
    line-height: 1.5;
    font-weight: 500;
    letter-spacing: 0.01em;
  }
  
  p, .body {
    line-height: 1.6;
    font-weight: 400;
  }
  
  .body-lg {
    font-size: 1.125rem;
    line-height: 1.7;
  }
  
  .body-md {
    font-size: 1rem;
    line-height: 1.6;
  }
  
  .body-sm {
    font-size: 0.875rem;
    line-height: 1.5;
  }
  
  .body-xs {
    font-size: 0.75rem;
    line-height: 1.4;
  }
  
  /* Text color hierarchy for better readability */
  .text-primary-foreground {
    color: hsl(var(--foreground));
  }
  
  .text-secondary-foreground {
    color: hsl(var(--muted-foreground));
  }
  
  .text-tertiary-foreground {
    color: hsl(var(--muted-foreground) / 0.7);
  }
  
  /* Ensure cards are dark in dark mode ONLY - fix white text on light cards */
  /* Use broad selector to catch all card elements, but exclude chat messages */
  :root[data-color-scheme='dark'] div[class*="rounded-2xl"]:not([class*="max-w-[85%]"]),
  .dark div[class*="rounded-2xl"]:not([class*="max-w-[85%]"]) {
    background-color: hsl(0 8% 14%) !important; /* Dark card background */
    color: hsl(0 0% 98%) !important; /* Light text on dark card */
  }
  
  /* Alternative theme dark mode cards */
  [data-color-theme='alternative'][data-color-scheme='dark'] div[class*="rounded-2xl"]:not([class*="max-w-[85%]"]),
  [data-color-theme='alternative'].dark div[class*="rounded-2xl"]:not([class*="max-w-[85%]"]) {
    background-color: hsl(210 40% 10%) !important; /* Dark blue card background */
    color: hsl(0 0% 96%) !important; /* Light text on dark blue card */
  }
  
  /* Chat message colors - override global rules */
  div[class*="max-w-[85%]"][class*="rounded-2xl"] {
    background-color: rgb(229, 231, 235) !important; /* gray-200 */
    color: rgb(17, 24, 39) !important; /* gray-900 */
  }
  
  div[class*="max-w-[85%]"][class*="rounded-2xl"][class*="ml-auto"] {
    background-color: rgb(59, 130, 246) !important; /* blue-500 */
    color: rgb(255, 255, 255) !important; /* white */
  }
  
  .dark div[class*="max-w-[85%]"][class*="rounded-2xl"]:not([class*="ml-auto"]) {
    background-color: rgb(55, 65, 81) !important; /* gray-700 */
    color: rgb(243, 244, 246) !important; /* gray-100 */
  }
  
  .dark div[class*="max-w-[85%]"][class*="rounded-2xl"][class*="ml-auto"] {
    background-color: rgb(37, 99, 235) !important; /* blue-600 */
    color: rgb(255, 255, 255) !important; /* white */
  }

/* Prevent calendar selected days from changing row height; draw frame inward */
.rdp-day[data-selected="true"],
.rdp-day[data-range-start="true"],
.rdp-day[data-range-end="true"],
.rdp-day[data-range-middle="true"] {
  border-width: 0 !important;
  box-shadow: inset 0 0 0 2px hsl(var(--primary));
}

/* Lock calendar cell sizing so borders/rings do not shift rows */
[data-slot="calendar"] .rdp-day {
  height: var(--cell-size);
  min-height: var(--cell-size);
  max-height: var(--cell-size);
}

[data-slot="calendar"] .rdp-day > button {
  width: 100%;
  height: 100%;
}
}

/* Tagline animation - GPU accelerated */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translate3d(0, 10px, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

.tagline-animate {
  animation: fadeIn 0.6s ease-out;
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* Evidence highlight when jumping from calendar/heatmap */
@keyframes evidenceHighlightPulse {
  0% {
    box-shadow: 0 0 0 0 hsl(var(--destructive) / 0.3);
    transform: translate3d(0, 0, 0);
  }
  50% {
    box-shadow: 0 0 0 12px hsl(var(--destructive) / 0);
    transform: translate3d(0, -1px, 0);
  }
  100% {
    box-shadow: 0 0 0 0 hsl(var(--destructive) / 0);
    transform: translate3d(0, 0, 0);
  }
}

.evidence-highlight {
  position: relative;
  outline: 2px solid hsl(var(--destructive));
  outline-offset: 2px;
  border-color: hsl(var(--destructive)) !important;
  animation: evidenceHighlightPulse 1.1s ease-out 0s 2;
  will-change: box-shadow, transform, outline-color, border-color;
  backface-visibility: hidden;
}

.dark .evidence-highlight {
  outline-color: hsl(var(--destructive));
}

@media (prefers-reduced-motion: reduce) {
  .evidence-highlight {
    animation: none;
  }
}

/* Card resize animation - smooth height transitions */
[data-upload-card] {
  transition: 
    height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    min-height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    padding 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  will-change: height, min-height, padding, transform;
  overflow: visible;
}

/* Smooth transitions for card content - force height transitions */
[data-upload-card] [class*="CardContent"] {
  transition: height 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
  transition: min-height 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
  transition: padding 0.5s cubic-bezier(0.4, 0, 0.2, 1) !important;
  transition: opacity 0.3s ease-in-out !important;
  will-change: height, min-height, padding;
  overflow: visible;
}

/* Smooth transitions for inner content containers */
[data-upload-card] [class*="CardContent"] > div {
  transition: 
    height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    min-height 0.5s cubic-bezier(0.4, 0, 0.2, 1),
    opacity 0.3s ease-in-out,
    transform 0.5s cubic-bezier(0.4, 0, 0.2, 1);
}

/* Animation keyframes for mode switching */
@keyframes fadeInSlideRight {
  from {
    opacity: 0;
    transform: translateX(20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

@keyframes fadeInSlideLeft {
  from {
    opacity: 0;
    transform: translateX(-20px);
  }
  to {
    opacity: 1;
    transform: translateX(0);
  }
}

[data-upload-card].analyzing {
  transform: scale(0.99);
  animation: cardResizePulse 0.6s ease-out;
}

@keyframes cardResizePulse {
  0% {
    transform: scale(0.98);
  }
  50% {
    transform: scale(1.01);
  }
  100% {
    transform: scale(1);
  }
}

/* GPU-accelerated blob animation - reduced on mobile */
@keyframes blob {
  0% {
    transform: translate3d(0px, 0px, 0) scale(1);
  }
  33% {
    transform: translate3d(30px, -50px, 0) scale(1.1);
  }
  66% {
    transform: translate3d(-20px, 20px, 0) scale(0.9);
  }
  100% {
    transform: translate3d(0px, 0px, 0) scale(1);
  }
}

@keyframes gaslight-wobble {
  0% {
    transform: translate3d(-10px, -4px, 0) scale(1.02) rotate(0deg);
    opacity: 0.6;
  }
  28% {
    transform: translate3d(26px, -24px, 0) scale(1.08) rotate(1deg);
    opacity: 0.7;
  }
  60% {
    transform: translate3d(-18px, 22px, 0) scale(0.96) rotate(-1.5deg);
    opacity: 0.55;
  }
  100% {
    transform: translate3d(-10px, -4px, 0) scale(1.02) rotate(0deg);
    opacity: 0.6;
  }
}

@keyframes gaslight-noise {
  0% {
    transform: translate3d(0, 0, 0) scale(1);
    opacity: 0.3;
  }
  50% {
    transform: translate3d(12px, -10px, 0) scale(1.03);
    opacity: 0.4;
  }
  100% {
    transform: translate3d(-8px, 6px, 0) scale(0.99);
    opacity: 0.32;
  }
}

@keyframes gaslight-flicker {
  0% {
    opacity: 1;
  }
  18% {
    opacity: 0.94;
  }
  22% {
    opacity: 1;
  }
  46% {
    opacity: 0.9;
  }
  50% {
    opacity: 1;
  }
  78% {
    opacity: 0.92;
  }
  82% {
    opacity: 1;
  }
}

/* Enhanced upload card hover effects */
[data-upload-card].group\/upload-card {
  transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

[data-upload-card].group\/upload-card:hover {
  transform: translateY(-2px);
  box-shadow: 
    0 20px 25px -5px rgba(0, 0, 0, 0.1),
    0 10px 10px -5px rgba(0, 0, 0, 0.04),
    0 0 0 1px hsl(var(--primary) / 0.1),
    0 0 20px hsl(var(--primary) / 0.1);
  border-color: hsl(var(--primary) / 0.3);
}

/* Disable animations only when user explicitly prefers reduced motion */
@media (prefers-reduced-motion: reduce) {
  .animate-blob,
  .animate-blob-gaslight,
  .animate-ripple,
  .matrix-stream::before,
  .matrix-stream::after {
    animation: none !important;
    opacity: 0 !important;
  }
}

/* Disable background animations on mobile for performance */
@media (max-width: 768px) {
  .animate-blob,
  .animate-blob-gaslight,
  .animate-ripple,
  .matrix-stream::before,
  .matrix-stream::after {
    animation: none !important;
    opacity: 0 !important;
  }
}

/* Force white text on badges in dark theme - mobile and desktop */
.dark [class*="rounded-md"][class*="border"][class*="bg-primary/10"],
.dark [class*="rounded-md"][class*="border"][class*="bg-secondary/20"],
.dark [class*="rounded-md"][class*="border"][class*="bg-emerald-500/15"],
[data-color-scheme='dark'] [class*="rounded-md"][class*="border"][class*="bg-primary/10"],
[data-color-scheme='dark'] [class*="rounded-md"][class*="border"][class*="bg-secondary/20"],
[data-color-scheme='dark'] [class*="rounded-md"][class*="border"][class*="bg-emerald-500/15"] {
  color: white !important;
}

.animate-blob {
  animation: blob 7s infinite;
  will-change: transform;
  backface-visibility: hidden;
  perspective: 1000px;
}

.animate-blob-gaslight {
  animation:
    blob 16s ease-in-out infinite alternate,
    gaslight-flicker 18s ease-in-out infinite;
  will-change: transform, opacity;
  backface-visibility: hidden;
  perspective: 1000px;
}

.gaslight-blob {
  filter: blur(32px) saturate(1.08) contrast(1.02);
  mix-blend-mode: screen;
  opacity: 0.4;
}

.dark .gaslight-blob,
[data-color-scheme='dark'] .gaslight-blob {
  mix-blend-mode: screen;
}

:root:not(.dark) .gaslight-blob,
[data-color-scheme='light'] .gaslight-blob {
  mix-blend-mode: multiply;
  opacity: 0.38;
  filter: blur(28px) saturate(1.02) contrast(1.0);
}

.gaslight-noise {
  background-image:
    radial-gradient(circle at 12% 18%, rgba(255, 255, 255, 0.08) 0%, transparent 34%),
    radial-gradient(circle at 82% 12%, rgba(255, 255, 255, 0.05) 0%, transparent 32%),
    radial-gradient(circle at 50% 82%, rgba(255, 255, 255, 0.06) 0%, transparent 34%),
    radial-gradient(circle at 18% 74%, rgba(255, 255, 255, 0.04) 0%, transparent 32%);
  mix-blend-mode: soft-light;
  opacity: 0.24;
  animation: gaslight-noise 22s ease-in-out infinite;
  filter: blur(14px) saturate(1.02);
}

:root:not(.dark) .gaslight-noise,
[data-color-scheme='light'] .gaslight-noise {
  mix-blend-mode: multiply;
  opacity: 0.18;
  filter: blur(12px) saturate(1.0);
}

.will-change-transform {
  will-change: transform;
  backface-visibility: hidden;
  transform: translate3d(0, 0, 0);
}

.animation-delay-2000 {
  animation-delay: 2s;
}

.animation-delay-4000 {
  animation-delay: 4s;
}

/* Mid-size fallback: soften blob/noise to cut GPU overdraw */
@media (max-width: 1200px) {
  .animate-blob-gaslight {
    animation: blob 18s ease-in-out infinite alternate;
  }
  .gaslight-blob,
  .gaslight-noise {
    filter: none;
    opacity: 0.22;
  }
}

/* Matrix-style running text background with soft, shifting highlights */
.matrix-stream {
  position: absolute;
  inset: 0;
  overflow: hidden;
  pointer-events: none;
  mix-blend-mode: screen;
  --matrix-text: 'echo shift delta nova flux \A prism drift coil glitch synapse \A neon cipher drift ghost trace bloom \A locus shard qubit fold arc node \A vector bloom signal frost pulse \A dune veil cipher spark drift neon \A coil shard prism echo nova flux \A shard neon vector ghost code pulse';
  --matrix-speed: 24s;
  --pulse-x: 22%;
  --pulse-y: 32%;
}

.matrix-stream::before,
.matrix-stream::after {
  content: var(--matrix-text);
  position: absolute;
  inset: -40% 0;
  font-family: 'SFMono-Regular', 'Roboto Mono', Menlo, Consolas, monospace;
  font-size: clamp(10px, 0.9vw, 13px);
  line-height: 1.5;
  letter-spacing: 0.08em;
  white-space: pre-wrap;
  text-transform: lowercase;
  transform: translate3d(0, 0, 0);
  will-change: transform, opacity;
}

.matrix-stream::before {
  color: hsl(var(--foreground) / 0.05);
  filter: blur(0.6px) saturate(0.9);
  animation: matrix-scroll var(--matrix-speed) linear infinite;
}

.matrix-stream::after {
  color: hsl(var(--primary, var(--foreground)) / 0.22);
  opacity: 0.32;
  filter: blur(0.4px) saturate(1.05);
  mix-blend-mode: screen;
  animation:
    matrix-scroll calc(var(--matrix-speed) * 0.85) linear infinite,
    matrix-pulse 10s ease-in-out infinite alternate;
  mask-image: radial-gradient(
    140% 80% at var(--pulse-x, 50%) var(--pulse-y, 50%),
    rgba(255, 255, 255, 0.95),
    rgba(255, 255, 255, 0.0) 65%
  );
  -webkit-mask-image: radial-gradient(
    140% 80% at var(--pulse-x, 50%) var(--pulse-y, 50%),
    rgba(255, 255, 255, 0.95),
    rgba(255, 255, 255, 0.0) 65%
  );
}

/* Love background helpers */
.love-cloud-item {
  transition:
    opacity 1.2s ease,
    filter 1.2s ease;
  opacity: var(--love-opacity, 0.12);
  filter: blur(var(--love-blur, 1.8px));
}

.love-appearing {
  opacity: 0;
  filter: blur(calc(var(--love-blur-strong, 2.2px) * 1.4));
}

.love-cloud-item.love-fading {
  opacity: 0;
  filter: blur(calc(var(--love-blur-strong, 2.2px) * 1.35));
}


.love-spotlight-mask {
  pointer-events: none;
  background: radial-gradient(
    38% 38% at 50% 50%,
    rgba(255, 255, 255, 0.22) 0%,
    rgba(255, 255, 255, 0.12) 35%,
    rgba(255, 255, 255, 0) 70%
  );
  mix-blend-mode: soft-light;
  opacity: 0.55;
}

@keyframes love-spotlight {
  0% { transform: translate3d(-12%, -8%, 0) scale(1.05); }
  25% { transform: translate3d(6%, -4%, 0) scale(1.08); }
  50% { transform: translate3d(10%, 8%, 0) scale(1.02); }
  75% { transform: translate3d(-8%, 10%, 0) scale(1.06); }
  100% { transform: translate3d(-12%, -8%, 0) scale(1.05); }
}

@keyframes matrix-scroll {
  0% {
    transform: translate3d(0, -25%, 0);
  }
  100% {
    transform: translate3d(0, 25%, 0);
  }
}

@keyframes matrix-pulse {
  0% {
    --pulse-x: 18%;
    --pulse-y: 26%;
    opacity: 0.18;
  }
  35% {
    --pulse-x: 72%;
    --pulse-y: 38%;
    opacity: 0.34;
  }
  65% {
    --pulse-x: 42%;
    --pulse-y: 72%;
    opacity: 0.26;
  }
  100% {
    --pulse-x: 86%;
    --pulse-y: 58%;
    opacity: 0.32;
  }
}


/* Fade in animation */
@keyframes fade-in {
  from {
    opacity: 0;
  }
  to {
    opacity: 1;
  }
}

.animate-fade-in {
  animation: fade-in 0.2s ease-out;
}

/* Zoom in animation for modals - GPU accelerated */
@keyframes zoom-in {
  from {
    opacity: 0;
    transform: translate3d(0, 0, 0) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
  }
}

.animate-zoom-in-95 {
  animation: zoom-in 0.2s ease-out;
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* Shimmer animation for progress bar - GPU accelerated */
@keyframes shimmer {
  0% {
    transform: translate3d(-100%, 0, 0);
  }
  100% {
    transform: translate3d(100%, 0, 0);
  }
}

.animate-shimmer {
  animation: shimmer 2s infinite;
  will-change: transform;
  backface-visibility: hidden;
}

/* Pulse animation for icons */
@keyframes pulse-glow {
  0%, 100% {
    opacity: 1;
    transform: scale(1);
  }
  50% {
    opacity: 0.8;
    transform: scale(1.05);
  }
}

.animate-pulse-glow {
  animation: pulse-glow 2s ease-in-out infinite;
}

/* Subtle pulse animation for warning banners */
@keyframes pulse-subtle {
  0%, 100% {
    opacity: 1;
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  50% {
    opacity: 0.95;
    box-shadow: 0 10px 15px -3px rgba(245, 158, 11, 0.3), 0 4px 6px -2px rgba(245, 158, 11, 0.2);
  }
}

.animate-pulse-subtle {
  animation: pulse-subtle 3s ease-in-out infinite;
}

/* Slide in from top animation - GPU accelerated */
@keyframes slide-in-from-top {
  from {
    opacity: 0;
    transform: translate3d(0, -10px, 0);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0);
  }
}

.animate-slide-in-from-top-2 {
  animation: slide-in-from-top 0.3s ease-out;
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* Chat message slide up animation - for moving existing messages up */
@keyframes chat-slide-up {
  from {
    transform: translate3d(0, 0, 0);
    opacity: 1;
  }
  to {
    transform: translate3d(0, -12px, 0);
    opacity: 0.85;
  }
}

.animate-chat-slide-up {
  animation: chat-slide-up 0.5s ease-out forwards;
  will-change: transform, opacity;
  backface-visibility: hidden;
}

/* Chat fade gradient - matches card background for smooth text fade */
/* Card uses hsl(var(--card) / 0.85), so gradient must match card color */
.chat-fade-gradient {
  background: linear-gradient(to bottom, rgb(255 255 255 / 0.8), transparent);
}

:root[data-color-scheme='dark'] .chat-fade-gradient,
.dark .chat-fade-gradient {
  /* neutral-900 = #171717 = rgb(23, 23, 23) with 80% opacity - exact match to card */
  background: linear-gradient(to bottom, rgb(23 23 23 / 0.8), transparent);
}

[data-color-theme='alternative'][data-color-scheme='dark'] .chat-fade-gradient,
[data-color-theme='alternative'].dark .chat-fade-gradient {
  /* alternative dark theme card color with 80% opacity */
  background: linear-gradient(to bottom, rgb(15 20 25 / 0.8), transparent);
}

/* Enhanced slide in from bottom for new messages - GPU accelerated */
@keyframes slide-in-from-bottom-enhanced {
  from {
    opacity: 0;
    transform: translate3d(0, 20px, 0) scale(0.95);
  }
  to {
    opacity: 1;
    transform: translate3d(0, 0, 0) scale(1);
  }
}

.animate-slide-in-from-bottom-enhanced {
  animation: slide-in-from-bottom-enhanced 0.6s cubic-bezier(0.16, 1, 0.3, 1) forwards;
  will-change: transform, opacity;
  backface-visibility: hidden;
  perspective: 1000px;
}

/* Zoom in for radio buttons */
.animate-zoom-in-95 {
  animation: zoom-in 0.2s ease-out;
}

/* Smooth transitions for theme changes */
* {
  transition-property: background-color, border-color, color;
  transition-duration: 0.3s;
  transition-timing-function: ease;
}

/* Performance optimizations - content visibility for better rendering */
.card-section,
[data-upload-card],
[data-testimonial-card] {
  content-visibility: auto;
  contain-intrinsic-size: auto 500px;
}

[data-testimonial-track] {
  will-change: transform;
}

.animate-testimonial-marquee {
  animation-name: testimonial-marquee;
  animation-timing-function: linear;
  animation-iteration-count: infinite;
}

@keyframes testimonial-marquee {
  from {
    transform: translateX(0);
  }
  to {
    transform: translateX(-50%);
  }
}

/* Phone glass effect - dark, transparent, with reflections */
.phone-glass-card {
  background: 
    linear-gradient(135deg, rgba(0, 0, 0, 0.65) 0%, rgba(0, 0, 0, 0.55) 100%),
    linear-gradient(180deg, rgba(255, 255, 255, 0.1) 0%, transparent 50%);
  backdrop-filter: blur(20px) saturate(180%);
  -webkit-backdrop-filter: blur(20px) saturate(180%);
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.4),
    0 0 0 1px rgba(255, 255, 255, 0.05) inset,
    0 1px 0 rgba(255, 255, 255, 0.1) inset;
  position: relative;
}

/* Glass reflection overlay - simulates light hitting phone screen */
.phone-glass-card::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  height: 40%;
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.15) 0%,
    rgba(255, 255, 255, 0.08) 20%,
    transparent 60%
  );
  pointer-events: none;
  z-index: 1;
  border-radius: inherit;
}

/* Subtle side reflection */
.phone-glass-card::after {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  width: 30%;
  height: 100%;
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.12) 0%,
    rgba(255, 255, 255, 0.05) 30%,
    transparent 70%
  );
  pointer-events: none;
  z-index: 1;
  border-radius: inherit;
}

/* Dark mode adjustments for phone glass */
.dark .phone-glass-card {
  background: 
    linear-gradient(135deg, rgba(0, 0, 0, 0.7) 0%, rgba(10, 10, 10, 0.65) 100%),
    linear-gradient(180deg, rgba(255, 255, 255, 0.08) 0%, transparent 50%);
  border: 1px solid rgba(255, 255, 255, 0.08);
  box-shadow: 
    0 8px 32px rgba(0, 0, 0, 0.6),
    0 0 0 1px rgba(255, 255, 255, 0.03) inset,
    0 1px 0 rgba(255, 255, 255, 0.08) inset;
}

.dark .phone-glass-card::before {
  background: linear-gradient(
    180deg,
    rgba(255, 255, 255, 0.12) 0%,
    rgba(255, 255, 255, 0.06) 20%,
    transparent 60%
  );
}

.dark .phone-glass-card::after {
  background: linear-gradient(
    90deg,
    rgba(255, 255, 255, 0.1) 0%,
    rgba(255, 255, 255, 0.04) 30%,
    transparent 70%
  );
}

/* Ensure content is above reflections */
.phone-glass-card > * {
  position: relative;
  z-index: 2;
}

/* Text colors for phone glass content */
.phone-glass-content {
  color: rgba(255, 255, 255, 0.95);
}

.phone-glass-content .text-foreground,
.phone-glass-content h1,
.phone-glass-content h2,
.phone-glass-content h3,
.phone-glass-content h4,
.phone-glass-content h5,
.phone-glass-content h6 {
  color: rgba(255, 255, 255, 0.95) !important;
}

.phone-glass-content .text-muted-foreground {
  color: rgba(255, 255, 255, 0.7) !important;
}

/* Chat messages inside phone glass - enhanced visibility */
.phone-glass-card div[class*="max-w-[85%]"][class*="rounded-2xl"]:not([class*="ml-auto"]) {
  background-color: rgba(255, 255, 255, 0.15) !important;
  color: rgba(255, 255, 255, 0.95) !important;
  border: 1px solid rgba(255, 255, 255, 0.1);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
}

.phone-glass-card div[class*="max-w-[85%]"][class*="rounded-2xl"][class*="ml-auto"] {
  background-color: rgba(59, 130, 246, 0.8) !important; /* blue-500 with transparency */
  color: rgb(255, 255, 255) !important;
  border: 1px solid rgba(59, 130, 246, 0.3);
  backdrop-filter: blur(10px);
  -webkit-backdrop-filter: blur(10px);
  box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
}

/* Hide scrollbar but keep scrolling functionality */
.scrollbar-hide {
  -ms-overflow-style: none;  /* IE and Edge */
  scrollbar-width: none;  /* Firefox */
}

.scrollbar-hide::-webkit-scrollbar {
  display: none;  /* Chrome, Safari and Opera */
}

/* Love background helpers */
.love-cloud-item {
  transition:
    opacity 2.8s ease,
    transform 2.8s ease,
    filter 2.8s ease,
    left 2.8s ease,
    top 2.8s ease,
    font-size 2.8s ease;
}

@keyframes love-float {
  0% { transform: translate3d(0, 0, 0) scale(1); }
  50% { transform: translate3d(4px, -4px, 0) scale(1.01); }
  100% { transform: translate3d(-4px, 4px, 0) scale(0.99); }
}

.love-float {
  animation-name: love-float;
  animation-timing-function: ease-in-out;
  animation-iteration-count: infinite;
}

.love-spotlight-mask {
  pointer-events: none;
  background: radial-gradient(
    38% 38% at 50% 50%,
    rgba(255, 255, 255, 0.16) 0%,
    rgba(255, 255, 255, 0.08) 35%,
    rgba(255, 255, 255, 0) 70%
  );
  mix-blend-mode: soft-light;
  opacity: 0.4;
}

@keyframes love-spotlight {
  0% { transform: translate3d(-12%, -8%, 0) scale(1.05); }
  25% { transform: translate3d(6%, -4%, 0) scale(1.08); }
  50% { transform: translate3d(10%, 8%, 0) scale(1.02); }
  75% { transform: translate3d(-8%, 10%, 0) scale(1.06); }
  100% { transform: translate3d(-12%, -8%, 0) scale(1.05); }
}

/* Testimonial cards - responsive width for desktop */
/* Use fixed width to ensure exactly 3 cards fit */
@media (min-width: 768px) {
  [data-testimonial-card] {
    width: 310px !important;
    min-width: 310px;
    max-width: 310px;
  }
}

/* Override layer - highest priority for card styling using CSS Cascade Layers */
@layer overrides {
  /* Force all cards to use lighter, transparent colors with GPU acceleration */
  /* Using data attributes and maximum specificity selectors */
  [data-card="true"],
  [data-card="true"].rounded-2xl,
  [data-card="true"][class*="rounded-2xl"],
  [data-card="true"][class*="border"],
  [data-upload-card],
  [data-upload-card].rounded-2xl,
  [data-upload-card][class*="rounded-2xl"],
  [data-upload-card][class*="border"],
  [data-testimonial-card],
  [data-testimonial-card][class*="rounded-2xl"],
  [class*="rounded-2xl"][class*="border"]:not([class*="max-w-[85%]"]):not(.phone-glass-card),
  div[class*="rounded-2xl"][class*="border"]:not([class*="max-w-[85%]"]):not(.phone-glass-card),
  .rounded-2xl.border:not(.phone-glass-card):not([class*="max-w-[85%]"]) {
    background-color: hsl(var(--card) / 0.85) !important;
    will-change: background-color, opacity, backdrop-filter !important;
    backface-visibility: hidden !important;
    /* GPU-accelerated backdrop blur for all cards - reduced on mobile */
    backdrop-filter: blur(16px) saturate(180%) !important;
    -webkit-backdrop-filter: blur(16px) saturate(180%) !important;
    transform: translate3d(0, 0, 0) !important;
  }
  
  /* Reduce blur on mobile for better performance */
  @media (max-width: 768px) {
    [data-card="true"],
    [data-card="true"].rounded-2xl,
    [data-card="true"][class*="rounded-2xl"],
    [data-card="true"][class*="border"],
    [data-upload-card],
    [data-upload-card].rounded-2xl,
    [data-upload-card][class*="rounded-2xl"],
    [data-upload-card][class*="border"],
    [data-testimonial-card],
    [data-testimonial-card][class*="rounded-2xl"],
    [class*="rounded-2xl"][class*="border"]:not([class*="max-w-[85%]"]):not(.phone-glass-card),
    div[class*="rounded-2xl"][class*="border"]:not([class*="max-w-[85%]"]):not(.phone-glass-card),
    .rounded-2xl.border:not(.phone-glass-card):not([class*="max-w-[85%]"]) {
      backdrop-filter: blur(8px) saturate(120%) !important;
      -webkit-backdrop-filter: blur(8px) saturate(120%) !important;
    }
    
    [data-upload-card],
    [data-upload-card][data-card="true"],
    [data-upload-card][data-card] {
      backdrop-filter: blur(2px) saturate(100%) !important;
      -webkit-backdrop-filter: blur(2px) saturate(100%) !important;
    }
  }
  
  /* Maximum specificity override for any background classes */
  [data-card="true"][class*="bg-white"],
  [data-card="true"][class*="bg-neutral"],
  [data-upload-card][class*="bg-white"],
  [data-upload-card][class*="bg-neutral"],
  [data-upload-card][class*="bg-white"][class*="rounded-2xl"],
  [data-upload-card][class*="bg-neutral"][class*="rounded-2xl"],
  [class*="bg-white"][class*="rounded-2xl"]:not(.phone-glass-card),
  [class*="bg-white"][class*="border"]:not(.phone-glass-card),
  [class*="bg-neutral"][class*="rounded-2xl"]:not(.phone-glass-card),
  [class*="bg-neutral"][class*="border"]:not(.phone-glass-card) {
    background-color: hsl(var(--card) / 0.85) !important;
  }
  
  /* Ultra-specific selector for upload card - maximum specificity */
  /* Same opacity as other cards, but less blur and saturation for ripple visibility */
  [data-upload-card],
  [data-upload-card][data-card="true"],
  [data-upload-card][data-card],
  div[data-upload-card="true"][data-card="true"],
  div[data-upload-card][data-card="true"],
  div[data-upload-card].rounded-2xl.border,
  div[data-upload-card][class*="rounded-2xl"][class*="border"],
  div[data-upload-card][class*="rounded-2xl"][class*="border"][class*="shadow"],
  div[data-upload-card][class*="shadow-xl"],
  div[data-upload-card][class*="backdrop-blur"] {
    background-color: hsl(var(--card) / 0.85) !important;
    background: hsl(var(--card) / 0.75) !important;
    background-image: none !important;
    backdrop-filter: blur(4px) saturate(100%) !important;
    -webkit-backdrop-filter: blur(4px) saturate(100%) !important;
  }
  
  /* Use CSS variable if set */
  [style*="--card-bg"] {
    background-color: var(--card-bg, hsl(var(--card) / 0.5)) !important;
  }
}

/* Outside layer for maximum priority - same opacity, less blur and saturation for upload card */
/* Using highest specificity possible */
div[data-upload-card],
div[data-upload-card][class*="rounded-2xl"],
div[data-upload-card].rounded-2xl,
div[data-upload-card][data-card="true"],
div[data-upload-card][data-card],
div[data-upload-card][class*="border"],
div[data-upload-card][class*="shadow"],
div[data-upload-card][class*="backdrop-blur"],
div[data-upload-card][class*="shadow-xl"] {
  background-color: hsl(var(--card) / 0.75) !important;
  background: hsl(var(--card) / 0.75) !important;
  background-image: none !important;
  backdrop-filter: blur(4px) saturate(100%) !important;
  -webkit-backdrop-filter: blur(4px) saturate(100%) !important;
}

/* Nuclear option - target by all possible combinations */
[data-upload-card][data-card="true"].rounded-2xl.border,
[data-upload-card][data-card].rounded-2xl.border,
div[data-upload-card][data-card="true"].rounded-2xl.border.shadow-xl,
div[data-upload-card][data-card="true"][class*="shadow-xl"] {
  background-color: hsl(var(--card) / 0.75) !important;
  background: hsl(var(--card) / 0.75) !important;
  backdrop-filter: blur(4px) saturate(100%) !important;
  -webkit-backdrop-filter: blur(4px) saturate(100%) !important;
}

/* Use CSS variable override if set */
[style*="--card-bg-override"] {
  background-color: var(--card-bg-override) !important;
  background: var(--card-bg-override) !important;
}
